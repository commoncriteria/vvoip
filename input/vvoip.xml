<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>

<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

<Module boilerplate="yes" 
  target-product="VVoIP"
  target-products="VVoIP Devices" 
  name="Voice/Video over IP (VVoIP)" 
  xmlns="https://niap-ccevs.org/cc/v1" 
  xmlns:sec="https://niap-ccevs.org/cc/v1/section"
  xmlns:h="http://www.w3.org/1999/xhtml">

<!--    <cPP/>   -->                                 <!-- This empty element must be included here if this is a cPP. It must not be here if it is not.  -->

<!-- for FP -->
<!--
<Package name="TLS"                                   
    xmlns="https://niap-ccevs.org/cc/v1"
    xmlns:h="http://www.w3.org/1999/xhtml"
    xmlns:sec="https://niap-ccevs.org/cc/v1/section"
-->

<!-- For a PP-Module 
<Module
    name="Widget Clients"                              # Name of the Module  
    xmlns="https://niap-ccevs.org/cc/v1"               # Some html magic
    xmlns:h="http://www.w3.org/1999/xhtml"             # uses the "h" namespace for inline HTML
    xmlns:sec="https://niap-ccevs.org/cc/v1/section"   # The "sec" namespace for sections is available
    target-product="Widget"                            # Name of the TOE product
    target-products="Widgets"                          # Plural name of the TOE product (optional)
    boilerplate="yes"                                  # Whether to use boilerplate text by default (can be disabled in sections)
    short="Wid">                                       # A short name for the PP (e.g. App or MDF)
-->

  <!-- PPReference (all documents) -->
  <PPReference>
    <ReferenceTable>
      <PPVersion>1.1</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-04-11</PPPubDate>
      <Keywords>VVoIP</Keywords>
    </ReferenceTable>
  </PPReference>

<!-- Revision History (all documents) -->
  <RevisionHistory>
    <entry>
      <version>1.1</version>
      <date>2025-04-11</date>
      <subject>CC:2022 updates, incorporation of TDs</subject>
    </entry>
    <entry>
      <version>1.0</version>
      <date>2020-10-28</date>
      <subject>Initial publication</subject>
    </entry>
  </RevisionHistory>

  <include-pkg id="pkgSSH">
    <git>
      <url>https://github.com/commoncriteria/ssh</url>
      <branch>master</branch>
    </git>
    <url><![CDATA[https://www.niap-ccevs.org/protectionprofiles/515]]></url>
    
  </include-pkg>
  <include-pkg id="pkgTLS">
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>release-2.0</branch>
    </git>
    <url><![CDATA[https://www.niap-ccevs.org/protectionprofiles/465]]></url>
    <depends on="fcs-eap-ext-1"/>
  </include-pkg>
  <include-pkg id="pkgX509">
    <git>
      <url>https://github.com/commoncriteria/X509</url>
      <branch>master</branch>
    </git>
    <url><![CDATA[https://www.niap-ccevs.org/protectionprofiles/511]]></url>
  </include-pkg>
  <include-pkg id="pkgVPNC">
	<git>
	  <url>https://github.com/commoncriteria/vpnclient</url>
	  <branch>release-2.5</branch>
	</git>
	<url>https://www.niap-ccevs.org/protectionprofiles/487</url>
  </include-pkg>



  <!-- Introduction (all documents) -->
  <sec:Introduction>
    
    <!-- 1.1 Overview --> <!-- change -->
    <sec:Overview>
      The scope of this PP-Module is to describe the security functionality of a Voice/Video over IP (VVoIP)
      endpoint in terms of <xref g="CC"/> and to define functional and assurance requirements for such products. This PPModule is intended for use with the following Base-PPs:
      
      <h:ul>
        <h:li>Protection Profile for Application Software, Version 1.3 (App PP)</h:li>
        <h:li>collaborative Protection Profile for Network Devices, Version 2.2e (NDcPP)</h:li>
      </h:ul>
      
      <h:p>
        These Base-PPs are both valid because a VVoIP endpoint is a specific type of network device or software
        application that carries sensitive data over remote channels and uses protocols to do so that a typical
        network device or software application does not implement. Therefore, additional security requirements
        are necessary to ensure that sensitive communications are not subject to unauthorized disclosure to
        unintended recipients.
      </h:p><h:p>
        Note that the NDcPP defines an optional architecture for a “distributed TOE” that allows for security
        functionality to be spread across multiple distinct components. However, a TOE that conforms to the
        NDcPP and this PP-Module will not be a distributed TOE. All security functionality will be contained within
        a single physical device.
      </h:p>
    </sec:Overview>

	
	<!-- CC and Tech terms.  -->
	<!-- CC terms are auto-generated -->
	<!-- All tech terms are generated from the list below. -->
	<!-- You should add and delete tech terms as required by the technology type. -->
	<tech-terms>
	  <!-- To remove an irrlevant CC term from the document, use the <suppress> element -->
      <suppress>Extended Package</suppress>   
    <term full="Basic telephony functions">
	  	The basic functions a VVoIP phone must provide – pick up, dial tone, dial, talk.
    </term>
	  <term full="Call control">
	  	The packets exchanged between devices to establish, maintain, and tear down a
      telephony call.
	  </term>
	  <term full="Client">
	  	A VVoIP endpoint.
	  </term>
	  <term abbr="ESC" full="Enterprise Session Controller (ESC)">
	  	A VVoIP call control server for VVoIP devices.
	  </term>	  
	  <term full="H.323">
	  	A communications protocol defined by ITU-T that is used for creating, modifying, and
      terminating multimedia sessions with multiple participants.
	  </term>
	  <term abbr="P2P" full="Peer-to-Peer">
	  	A VVoIP architecture that forces each peer to be a server and client at the same time.
	  </term>
	  <term full="SDES-SRTP">
	  	A method of key negotiation for SRTP.</term>
	  <term abbr="SIP" full="Session Initiation Protocol">
	  	A communications protocol defined by IETF that is used for creating, modifying, and
      terminating multimedia sessions with multiple participants.</term>
	  <term abbr="SRTP" full="Secure Real-Time Transport Protocol">
	  	A protocol that is used to provide multimedia (voice/video) streaming services with
      added security of encryption, message authentication and integrity, and replay
      protection.</term>
    <term full="Sensitive Data">
      Call control/signal data, media data, and audit/management data that must be
      protected while in transit to prevent unauthorized disclosure. </term>
    <term full="Software/firmware update delivery channel">
      A trusted channel between a client and file server (which may be the same server as
      the call control server) for secure file download of software/firmware updates. </term>
    <term full="State">
      A configuration of a VVoIP endpoint based on how the user is currently using or not
      using the endpoint. Examples include:
      <h:ul><h:li>Hook state: whether the endpoint is active (off-hook) or inactive (on-hook)</h:li>
      <h:li>Mute state: the endpoint is active but is deliberately not transmitting data</h:li>
      <h:li>Hold state: the endpoint is active but is deliberately not transmitting or
        receiving data</h:li>
      </h:ul></term>
    <term full="Streaming media">
      The voice/video exchanged between VVoIP endpoints.</term>
    <term full="VVoIP Call Control Server">
      A VVoIP infrastructure device that performs call control functions between a client and
      other VVoIP endpoints; this may be either a dedicated device such as an ESC or a VVoIP
      device itself when using P2P.</term>
    </tech-terms>    

	<!-- Other sections can be added here. -->
	<!-- Commen examples include Scope of Document, Intended Audiance, Compliant Targets of Evaluation,
	     TOE Boundary, TOE Operational Environment, and Roles. These sections can also be included in the
		 TOE/PP Overview aove. -->

	<!-- 1.3 Compliant_Targets_of_Evaluation -->
    <sec:Compliant_Targets_of_Evaluation>
		<h:p>
			This PP-Module specifically addresses a dedicated network device or software application that facilitates
      the exchange of voice or video communication across an Internet Protocol (IP) network. The endpoint is
      a client (TOE) that communicates with a VVoIP call control server and may serve as its own call control
      server when using P2P. The VVoIP endpoint shall be able to secure file download from a file server to
      update VVoIP endpoint software and configuration, to establish secure communication for call control
      with the call control server, and to secure streaming media to other devices.
   	</h:p><h:p>
			The combination of the NDcPP and this PP-Module is a network device that provides VVoIP endpoint
      functionality in addition to all of the security functionality expected of a network device as mandated by
      the NDcPP. The combination of the App PP and this PP-Module is a software application running on a
      general-purpose operating system that includes VVoIP endpoint capabilities in addition to all of the
      security functionality expected of a software application as mandated by the App PP.
    </h:p><h:p>
      This PP-Module describes the functional requirements and threats specific to the VVoIP endpoint. The
      most notable additions are requirements for the call control protocol (SIP, H.323) and streaming media
      protocol (SRTP, RTP). A conformant TOE is expected to be a standalone device or application; distributed
      TOE’s are not permitted.
</h:p>
	</sec:Compliant_Targets_of_Evaluation>
	<!-- 1.4 TOE_Boundary -->
    <sec:TOE_Boundary>
        <h:p>The TOE boundary includes the VVoIP-capable device or application (VVoIP endpoint). A VVoIP-capable
			device is a dedicated phone whereas a VVoIP endpoint application is just one of many applications that
			runs on a general-purpose device such as a smartphone, tablet, or PC. Regardless of whether the TOE is a
			hardware appliance or a client application on an operating system, it will be deployed in the same
			environment. The figure below shows a typical VVoIP infrastructure from the perspective of the TOE.
			Many of the environmental components have direct connections between one another, but since these
			are not visible to the TOE, these connections have not been depicted.</h:p>
			<figure entity="images/Toe.png" title="Typical VVoIP Deployment" id="toeDeployment"/>
		<h:p>The TOE uses a VVoIP call control server, either by connecting to an ESC or acting as one itself when using
			P2P, in order to set up connections with other VVoIP endpoint devices or other telephony equipment such
			as a conference bridge. The call control server also may have the ability to deliver software/firmware
			updates to the TOE, but this can alternatively be performed by a file server. The TOE must be able to
			process Internet Protocol version 4 (IPv4) and/or IPv6 packets.</h:p>
		<h:p>To be able to initiate communications in a client-server architecture, the TOE needs at minimum an IP
			address, network mask, gateway address, configuration server address, update server address (or may
			rely on platform for updates if it is a software application configured to do so), and call control server
			address. The address may be obtained by Dynamic Host Configuration Protocol (DHCP), manually entered
			on the VVoIP endpoint, or inherited from the device the TOE resides on (if it is a software application);
			addresses can belong to the same device if it performs multiple functions (such as an ESC which also
			performs updates). The TOE should allow basic telephony functions. Once the IP addresses are obtained,
			the TOE downloads any VVoIP application updates, downloads VVoIP endpoint configuration, and
			connects to the call control server as a VVoIP client. When a call is finished or the line is otherwise not in
			use, the TOE will ensure that streaming media communication paths/ports are closed while call control
			remains open.</h:p>
		<h:p>The TOE has three paths for three different functions that need to execute: streaming media path that
			contains voice, video, and session control (endpoint to endpoint); call control path to control the endpoint
			(endpoint to VVoIP call control server), and configuration/management path to configure and manage the
			TOE (software/firmware updates, configuration updates, audit).</h:p>
			
    </sec:TOE_Boundary>


    <!-- 1.5 Use Cases -->
    <sec:Use_Cases>
    	<h:p>
			This PP-Module defines four potential use cases for the VVoIP TOE, defined below. The first two use cases
			define the physical embodiment of the TOE, while the latter two define its role in a telecommunications
			deployment.</h:p>
		<h:p>
			Regardless of the physical embodiment of the TOE, the expected functional capabilities are similar.
			However, when the TOE is deployed in a peer-to-peer architecture, it must perform auditing and call
			control functions that a client-server TOE does not need to perform because the Enterprise Session
			Controller provides those functions in that architecture. A client-server TOE may also perform its own
			auditing, but it is not required.</h:p>
      <usecases>
        <usecase id="usecase1" title="Dedicated Appliance">
          <description>
            The VVoIP endpoint is sold and packaged as a standalone network appliance that does not have
			a direct interface to the underlying platform operating system. In this use case, conformance to
			the NDcPP and this PP-Module is sufficient to ensure security. Note that the NDcPP defines
			optional functionality for “distributed TOEs” – for a TOE to conform to this PP-Module, it must be
			a single device and not a distributed TOE.
          </description>
        </usecase>
        
        <usecase id="usecase2" title="Software Application">
          <description>
            The VVoIP endpoint is sold and packaged as an application that is installed on a general-purpose
			computer or mobile device running a modifiable operating system (such as Windows or Linux).
			This computer may run end user applications above and beyond those used for VVoIP
			communications since it functions as a user workstation. In this case, the VVoIP endpoint
			application is expected to conform to both this PP-Module and the App PP. 
          </description>
        </usecase>
		<usecase id="usecase3" title="Client-Server Architecture">
		  <description>
		  	The VVoIP endpoint, whether hardware or software, is deployed in an environment where it
			interacts with an Enterprise Session Controller to facilitate call control functions.
		  </description>
		</usecase>

		<usecase id="usecase4" title="Peer-to-Peer Architecture">
		  <description>
		  	The VVoIP endpoint, whether hardware or software, is deployed in an environment where it
			interacts directly with other VVoIP endpoints without the use of an Enterprise Session Controller
			as an intermediary.
		  </description>
		</usecase>
      </usecases>

	  
    </sec:Use_Cases> 
    
 
	

	<!-- Product Features. Required if there are implementation-dependent requirements. -->
	<!-- These are the product features that are defined in order to support implementation-dependent requirements. -->
  
   <section title="Implementation-Based Features" id="sec-features">
      The following features of the TOE are implementation-based. A TOE is not required to implement these features to conform to this PP-Module, but if the feature is implemented, it is expected that associated implementation-based requirements are claimed as part of the TSF.  
      <implements>
        <feature id="feat-swapp" title="Software Application">
          <description>The TOE is a software application and claims the App-PP as the Base-PP.</description>
        </feature>
		<feature id="feat-device" title="Network Device">
			<description>The TOE is a network device and claims the NDcPP as the Base-PP.</description>
		</feature>
      </implements>			
    </section> 
  	
  	<!-- <section title="Test Environment for Evaluation Activities">
  		<h:p>
  		This section contains the expectations for the evaluator test environment that is used to perform the
  		test specified by the EAs.
  		</h:p><h:p>
  		It is assumed the evaluator will have tools suitable to establish sessions, modify or create session packets,
  		and perceive whether packets are getting through the TOE as well as to examine the content of those
  		packets. In general, it is expected that IPS rule configuration and logging capabilities of the TOE can be
  		used to reach appropriate determinations where applicable.
  		</h:p><h:p>
  		The tests need to be repeated for each distinct network interface type capable of monitoring network
  		traffic on all ‘sensor’ interfaces of the TOE, which may include ‘promiscuous’ interfaces (with or without
  		an IP address or IP stack, and whether or not the interfaces are capable of attempting to terminate
  		unapproved traffic flows by transmitting packets such as TCP resets), and inline (pass-through) interfaces
  		with or without an IP address or IP stack, but not management interfaces used to remotely access the
  		TOE, or used by the TOE to initiate outbound connections to syslog servers, AAA servers, remote traffic
  		filtering devices, etc.
  		</h:p><h:p>
  		The evaluators shall minimally create a test environment that is functionally equivalent to the test
  		environment illustrated below. The evaluators must provide justification for any differences in the test
  		environment. The TOE may be a distributed TOE in which some SFRs or elements of SFRs are enforced
  		by separate TOE components distributed across a network. For distributed TOEs: <h:ul>
  		<h:li>the “TOE” in the “inline mode test topology” must be the TOE component that controls the
  		flow of traffic, but that TOE component does not need to be the same component that collects
  		or analyzes the traffic;</h:li>
  		<h:li>the “TOE” in the “promiscuous mode test topology” must be the TOE component that
  		communicates with the non-TOE traffic filtering device, but that TOE component does not need
  		to be the same component that collects or analyzes the traffic.</h:li>
  		</h:ul>
  		</h:p><h:p>
  		IPS devices that can be deployed in more than one mode, two instantiations of the TOE will more than
  		likely make it easier to conduct testing, however, the evaluator is free to construct a test-bed where one
  		instance of a TOE exists and there is a device that provides the necessary functions to interact with the
  		TOE to satisfy the testing activities.
  		</h:p><h:p>
  			<figure entity="images/inline_mode.png" title="Sample Inline Mode Test Topology" id="inlinemode"/>
  	   <h:br/><h:br/>
  			<figure entity="images/promiscuous_mode.png" title="Sample Promiscuous Mode Test Topology" id="promiscuousmode"/>
  			
  		It is expected that the traffic generator is used to construct network packets and will provide the evaluator
  		with the ability to simulate network attacks. The traffic generator can be a COTS (commercial off the shelf),
  		shareware, or freeware product; special equipment is not necessary.
  		</h:p>
  		
  	</section> -->

</sec:Introduction>   <!-- Introduction  -->


	<!-- cc-version: cc-2022r1 or cc-31r5   -->
	<!-- cc-approach: standard or direct-rationale  -->
	<!-- display: Should this info be displayed in the Conformance -->
	<!-- Claims section? If no, you have to write a free-form section -->
    <section title="Conformance Claims" id="ConformanceClaims">
      
      <!-- 2.1 CC Conformance -->
      <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
        <cc-st-conf>exact</cc-st-conf>
        <cc-pt2-conf>extended</cc-pt2-conf>
        <cc-pt3-conf>extended</cc-pt3-conf>
        <cc-pp-conf/>
        <cc-pp-config-with/>
        <cc-pkg-claim>
			<FP-cc-ref conf="conformant">Functional Package for TLS, version 1.1</FP-cc-ref>
		</cc-pkg-claim>
      </CClaimsInfo>
    </section>  <!-- Conformance Claims -->
  

  
  <sec:Security_Problem_Definition>
  
    <!-- Arbitrary introductory text -->
  	<h:p>
	The security problem is described in terms of the threats that the TOE is expected to address, assumptions
	about its operational environment, and any organizational security policies that the TOE is expected to
	enforce.
  	</h:p>
    <section title="Threats" id="sec-threats">
	
		<!-- If using the standard approach, each threat references one of more Objectives -->
		<!-- using the <objective-refer> tag.   -->
		<!-- If using direct rationale, each threat references the SFRs that address the threat -->
		<!-- using the <addressed-by> tag.  -->
		The following threats defined in this PP-Module extend the threats defined by the Base-PP.

      <threats>
        <threat name="T.MEDIA_DISCLOSURE" id="t-media-disclosure">
          <description> An attacker can use the encrypted variable rate vocoder frames to their advantage to decode
			transmitted data.</description>

			<addressed-by>FCS_COP.1/DataEncryption (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining the AES encryption algorithm used to secure VVoIP communications.</rationale>
			<addressed-by>FCS_NTP_EXT.1 (from NDcPP)</addressed-by><rationale>Mitigates the threat by defining how accurate system time is maintained, which is used to support certain cryptographic functions.</rationale>
			<addressed-by>FCS_TLSC_EXT.1 (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining the TLS client implementation used to secure call control and streaming media channels used for VVoIP.</rationale>
			<addressed-by>FCS_TLSC_EXT.2 (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining the TOE’s implementation of mutual authentication for its TLS client</rationale>
			<addressed-by>FIA_X509_EXT.1/Rev (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining requirements for the use of X.509 certificates that TLS functionality depends on.</rationale>
			<addressed-by>FIA_X509_EXT.2 (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining requirements for the use of X.509 certificates that TLS functionality depends on.</rationale>
			<addressed-by>FIA_X509_EXT.3 (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining requirements for the use of X.509 certificates that TLS functionality depends on.</rationale>
			<addressed-by>FTP_ITC.1 (refined from NDcPP)</addressed-by><rationale>Mitigates the threat by defining the trusted communications channel used for VVoIP</rationale>
			<addressed-by>FTP_DIT_EXT.1 (refined from App PP)</addressed-by><rationale>Mitigates the threat by defining the trusted communications channel used for VVoIP.</rationale>
			<addressed-by>FCO_VOC_EXT.1</addressed-by><rationale>Mitigates the threat by defining the use of a fixed-rate vocoder to prevent the exposure of encryption vulnerabilities that are present with variable-rate vocoders.</rationale>
			<addressed-by>FTP_ITC.1/Control</addressed-by><rationale>Mitigates the threat by defining the application-layer channel used for communications with a VVoIP call control server.</rationale>
			<addressed-by>FTP_ITC.1/Media</addressed-by><rationale>Mitigates the threat by defining the application-layer channel used for communications of media (voice and video) data.</rationale>
			<addressed-by>FAU_STG_EXT.1 (optional for software-only TOEs)</addressed-by><rationale>Mitigates the threat by ensuring that audit data is securely transmitted to an external entity.</rationale>
			<addressed-by>FCS_COP.1/SRTP (selection-based)</addressed-by><rationale>Mitigates the threat by defining the implementation of encryption used for SDES-SRTP, if supported by the TOE.</rationale>
			<addressed-by>FCS_SRTP_EXT.1 (selection-based)</addressed-by><rationale>Mitigates the threat by defining the implementation of the SRTP protocol, if supported by the TOE.</rationale>
			<addressed-by>FDP_IFC.1/CallControl (selection-based)</addressed-by><rationale>Mitigates the threat by defining a policy for protection of call control information in cases where the TOE can act as a VVoIP call control server in a peer-to-peer configuration.</rationale>
			<addressed-by>FDP_IFF.1/CallControl (selection-based)</addressed-by><rationale>Mitigates the threat by defining the implementation of the call control policy in cases where the TOE can act as a VVoIP call control server in a peer-to-peer configuration.</rationale>
			<addressed-by>FPT_STM_EXT.1/VVoIP (selection-based)</addressed-by><rationale>Mitigates the threat by defining how the TSF obtains system time in certain cases, which is then used as an input to other functions that support this objective.</rationale>

        	

        </threat>

        <threat name="T.UNDETECTED_TRANSMISSION" id="t-undetected-transmission">
          <description> An attacker may cause the TOE to exfiltrate audio or video media over a remote channel while in a
			state where the user has a reasonable expectation that no media is being transmitted. </description>
        	
		  	<addressed-by>FDP_IFC.1</addressed-by><rationale>Mitigates the threat by defining the existence of a media transmission policy.</rationale>
			<addressed-by>FDP_IFF.1</addressed-by><rationale>Mitigates the threat by defining how the media transmission policy is enforced to determine when transmissions should occur.</rationale>
			<addressed-by>FTA_SSL.3/Media</addressed-by><rationale>Mitigates the threat by requiring the TSF to terminate idle sessions.</rationale>
			<addressed-by>FAU_GEN.1/CS-Admin (optional)</addressed-by><rationale>Mitigates the threat by optionally allowing a clientserver TOE to provide an audit trail of administrative actions, which could diagnose mis-configuration of the TOE that could lead to unattended transmissions.</rationale>
			<addressed-by>FAU_GEN.1/CS-VVoIP (optional)</addressed-by><rationale>Mitigates the threat by optionally allowing a clientserver TOE to provide an audit trail of call data, which could diagnose when unattended transmissions may be occurring.</rationale>
			<addressed-by>FAU_GEN.1/P2P-Admin (selection-based)</addressed-by><rationale>Mitigates the threat by requiring a peer-to-peer TOE to provide an audit trail of administrative actions, which could diagnose mis-configuration of the TOE that could lead to unattended transmissions.</rationale>
			<addressed-by>FAU_GEN.1/P2PVVoIP (selection-based)</addressed-by><rationale>Mitigates the threat by requiring a peer-to-peer TOE to provide an audit trail of call data, which could diagnose when unattended transmissions may be
			occurring.</rationale>
			<addressed-by>FPT_STM_EXT.1/VVoIP (selection-based)</addressed-by><rationale>Mitigates the threat by requiring the TSF to specify how it obtains system time in certain cases, which is then used as an input to other functions that support this objective.</rationale>
			<addressed-by>FMT_SMF.1/VVoIP</addressed-by><rationale>Mitigates the threat by requiring the TSF to implement certain the management functions specific to VVoIP functionality.</rationale>

        	
		  </threat>
		
      </threats>
    </section>  <!-- Threats -->
	
	<!-- Assumptions refer to operational objective objectives regardless of whether -->
	<!-- the document uses standard or direct rationale. -->
	
    <sec:Assumptions>
		<h:p>
		The following assumptions that are defined in this PP-Module extend the assumptions that are defined
		by the Base-PPs.
		</h:p>

      <assumptions>
        <assumption name="A.UPDATE_SOURCE">
          <description> It is assumed that TOE software/firmware updates will be made available on either the call control
			server that the TOE connects to or a separate file server managed by the organization. <h:p/>
			Note that because this PP-Module specifically disallows distributed TOEs, a conformant TOE will not claim
			OE.COMPONENTS_RUNNING when NDcPP is the Base-PP.
		  </description>
          <objective-refer ref="OE.UPDATE_SOURCE">
            <rationale> The objective satisfies the assumption
			by ensuring that TOE updates are
			made available in the intended location. 
			</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </sec:Assumptions>  <!-- Assumptions -->
	
	<!-- OSPs refer to Objectives or OE Objectives in standard approach documents. -->
	<!-- In direct rationale PPs, they should refer to OE Objectives -->
    <sec:Organizational_Security_Policies>
      <OSPs/>
    </sec:Organizational_Security_Policies>
  </sec:Security_Problem_Definition> <!-- Security Problem Definition -->
  
  
  <!-- This section is mandatory for standard approach documents.   -->
  <!-- It should be included in direct rationale documents if there are OE Objectives. -->
  <sec:Security_Objectives>

	<!-- This section is included in direct rationale documents if there are OE Objectives -->
    <sec:Security_Objectives_for_the_Operational_Environment>
		<h:p>
		The following environmental security objectives that are defined in this PP-Module extend the objectives
		that are defined by the Base-PPs.
		</h:p>
	  <SOEs>
        <SOE name="OE.UPDATE_SOURCE">
          <description>TOE administrators will ensure that the TOE is installed in a manner that will allow the TOE to effectively
enforce its policies on network traffic of monitored networks.</description>
        </SOE>
      </SOEs>
      </sec:Security_Objectives_for_the_Operational_Environment>  <!-- OE Objectives -->

	<!-- This section is automatically generated, but this placeholder is reuired -->
    <section title="Security Objectives Rationale" id="sec-sor"/>

  </sec:Security_Objectives>  <!-- Security_Objectives  -->


  
  <sec:Security_Requirements>
    <base-pp id="ND" version="3.0e" name="Network Device" product="Network Device" short="ND" plural="Network Devices">
      <url>https://www.niap-ccevs.org/protectionprofiles/482</url>
      <cPP/>
      <sec-func-req-dir> 
        In a PP-Configuration that includes the NDcPP, the VVoIP client is expected to rely on some of the security
		functions implemented by the network device as a whole and evaluated against the NDcPP. In this case,
		the following sections describe any modifications that the ST author must make to the SFRs defined in the
		NDcPP in addition to what is mandated by section 5.3.
		<!-- QQQQ: Verify this section number is correct. -->
      </sec-func-req-dir>
      <modified-sfrs>
	  	<section title="Security Audit (FAU)" id="nd-mod-fau">
			<base-sfr-spec cc-id="fau_stg_ext.1" title="Protected Audit Event Storage" id="nd-mod-fau-stg-ext-1">
				<consistency-rationale>
				This PP-Module modifies this SFR to prohibit the selection of any
				“distributed TOE” behavior in FAU_STG_EXT.1.2. The SFR is otherwise
				unchanged.</consistency-rationale>
				<description>
				<h:p>This SFR is modified to prohibit the selection of distributed TOE options. Any element not mentioned in this 
				section is unchanged from its definition in the Base-PP.</h:p>
				<h:p>The text of FAU_STG_EXT.1.2 is replaced with:</h:p>
				<h:p><h:b>FAU_STG_EXT.1.2: </h:b>The TSF shall be able to store generated audit data on the TOE itself.
				<h:ul><h:li>[<h:i>The TOE shall consist of a single standalone component that stores audit
					data locally</h:i>].</h:li></h:ul></h:p>
				<h:p><h:b>Application Note: </h:b>This PP-Module modifies the existing FAU_STG_EXT.1 SFR in the NDcPP to prohibit
				the selection of any “distributed TOE” behavior in FAU_STG_EXT.1.2. The SFR is
				otherwise unchanged.</h:p>
				</description>
				<!-- NDcPP not in XML so no change can be modeled -->
				<no-change/>
			</base-sfr-spec>
		</section>
		<section title="Crytographic Support (FCS)" id="nd-mod-fcs">
			<base-sfr-spec cc-id="fcs_ntp_ext.1" title="NTP Protocol" id="nd-mod-fcs-ntp-ext-1"> 
				<consistency-rationale>This PP-Module does not modify this SFR; it only modifies the circumstances
				that trigger its inclusion in the TOE’s logical boundary.</consistency-rationale>
				<description>
					<h:p>This SFR is selection-based in the NDcPP and remains selection-based in this PP-Module. However, an
					additional trigger for this SFR’s inclusion is added for the selection of “register the TOE to an ESC…” in
					FMT_SMF.1/VVoIP. This is because any VVoIP TOE that can be registered to ESCs is required to use them
					as NTP servers.</h:p>
					<h:p>If the TOE is not registered to an ESC, it is not relevant to this PP-Module whether or not NTP is
					implemented, and in this case this SFR remains selection-based on FPT_STM_EXT.1.2, which is not
					modified by this PP-Module (i.e. a peer-to-peer TOE does not register to an ESC but may still receive time
					data from a separate NTP source).</h:p>
				</description>
				<no-change/>
			</base-sfr-spec>
			<base-sfr-spec cc-id="fcs_tlsc_ext.1" title="TLS Client Protocol without Mutual Authentication" id="nd-mod-fcs-tlsc-ext-1">
				<consistency-rationale>This PP-Module does not modify this SFR; it only forces its inclusion because
				a conformant TOE must implement TLS client functionality.</consistency-rationale>
				<description>This SFR is selection-based in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/465">Functional Package for TLS, version 2.0</h:a> but is mandated by this PP-Module because TLS is used to secure
				call control and streaming media channels regardless of the application protocol used. There is no change
				to the SFR text itself.
				</description>
				<no-change/>
			</base-sfr-spec>
			<base-sfr-spec cc-id="fcs_tlsc_ext.2" title="TLS Client Support for Mutual Authentication" id="nd-mod-fcs-tlsc-ext-2">
				<consistency-rationale>This PP-Module does not modify this SFR; it only forces its inclusion because
				a conformant TOE must implement a TLS client that enforces mutual
				authentication.</consistency-rationale>
				<description>This SFR is optional in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/465">Functional Package for TLS, version 2.0</h:a> 
				but is mandated by this PP-Module because the TLS implementation that
				is used to secure call control and streaming media channels must be secured using mutual authentication.
				There is no change to the SFR text itself.</description>
				<no-change/>
			</base-sfr-spec>
		</section>
		<section title="Identification and Authorization (FIA)" id="nd-mod-fia">
			<base-sfr-spec cc-id="fia_x509_ext.1" iteration="Rev" title="X.509 Certificate Validation" id="nd-mod-fia-x509-ext-1">
				<consistency-rationale>This PP-Module does not modify this SFR; it only forces its inclusion because
				X.509 services are required to support TLS client functionality.</consistency-rationale>
				<description>This SFR is selection-based in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/511">Functional Package for X.509, version 1.0</h:a> 
				but is mandated by this PP-Module because it is a dependency
				on the TLS functionality that this PP-Module requires. There is no change to the SFR text itself.</description>
				<no-change/>
			</base-sfr-spec>
			<base-sfr-spec cc-id="fia_x509_ext.2" title="X.509 Certificate Authentication" id="nd-mod-fia-x509-ext-2">
				<consistency-rationale>This PP-Module does not modify this SFR; it only forces its inclusion because
				X.509 services are required to support TLS client functionality.</consistency-rationale>
				<description>This SFR is selection-based in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/511">Functional Package for X.509, version 1.0</h:a> 
				but is mandated by this PP-Module because it is a dependency
				on the TLS functionality that this PP-Module requires. There is no change to the SFR text itself.</description>
			<no-change/>
			</base-sfr-spec>
			<base-sfr-spec cc-id="fia_x509_ext.3" title="X.509 Certificate Requests" id="nd-mod-fia-x509-ext-3">
				<consistency-rationale>This PP-Module does not modify this SFR; it only forces its inclusion because
				X.509 services are required to support TLS client functionality.</consistency-rationale>
				<description>This SFR is selection-based in the NDcPP but is mandated by this PP-Module because it is a dependency
				on the TLS functionality that this PP-Module requires. There is no change to the SFR text itself.
				</description>
				<no-change/>
			</base-sfr-spec>
		</section>
		<section id="nd-mod-fpt" title="Protection of the TSF (FPT)">
			<base-sfr-spec cc-id="fpt_tud_ext.1" title="Trusted Update" id="nd-mod-fpt-tud-ext-1">
				<consistency-rationale>This PP-Module does not modify this SFR; it only specifies that the source of
				TOE software/firmware updates must be a specific type of server.
				</consistency-rationale>
				<description>This PP-Module does not modify this SFR as it is defined in the NDcPP. However, note that this PP-Module
				expects that either the call control server or a separate file server managed by the organization to function
				as the source of TOE software/firmware updates. The evaluator shall ensure that the test environment is
				configured appropriately.</description>
				<no-change/>
			</base-sfr-spec>
		</section>
		<section id="nd-mod-ftp" title="Trusted Path (FTP)">
			<base-sfr-spec cc-id="ftp_itc.1" title="Inter-TSF Trusted Channel" id="nd-mod-ftp-itc-1">
				<consistency-rationale>This PP-Module restricts the Base-PP SFR to a subset of existing permissible
				functionality and does not introduce any new behavior.</consistency-rationale>
				<description>
				<h:p>This SFR is modified to mandate the inclusion of TLS. Any other protocols may additionally be claimed. 
				Any element that is not included in this section is unchanged from its definition in the Base-PP.</h:p>
				<h:p>The text of the requirement is replaced with:</h:p>
				<h:p><h:b>FTP_ITC.1.1: </h:b>The TSF shall be capable of using <h:b>TLS and </h:b>[<h:b>selection: </h:b><h:i>IPsec, SSH, DTLS, HTTPS, <h:b>no other protocols</h:b></h:i>]
					to provide a trusted communication channel between itself and authorized IT entities supporting the following capabilities: audit server, 
					<h:b>streaming media channel, call control channel, software/firmware update delivery channel, </h:b> [<h:b>selection: </h:b><h:i>authentication server, 
					[<h:b>assignment: </h:b>other capabilities], no other capabilities</h:i>] that is logically distinct from other communication channels and provides assured identification 
					of its end points and protection of the channel data from disclosure and detection of modification of the channel data.
				</h:p>
				<h:p>
					<h:b>Application Note: </h:b> The NDcPP provides the ability for the ST author to specify the protocols used to
					establish trusted communications in FTP_ITC.1.1. This PP-Module mandates the inclusion of TLS because it is the underlying protocol used to secure
					communications with the ESC and other VVoIP endpoints. Additional protocols
					should be selected if they are used for securing other trusted channels. For
					example, the TSF may communicate with an ESC using TLS for call control
					functions but some other protocol for remote transmission of audit data. This PP-Module also specifies 
					additional uses for the trusted channel beyond what the NDcPP defines. 
					The remainder of the SFR is unchanged from its definition in the Base-PP.
				</h:p>
				</description>
				<!-- NDcPP not in XML so no change can be modeled -->
				<no-change/>
			</base-sfr-spec>
		</section>
	  </modified-sfrs>
      <additional-sfrs/>
      <con-toe>
        When this PP-Module is used to extend the NDcPP, the TOE type for the overall TOE is still a network
		device. The TOE boundary is simply extended to include VVoIP endpoint functionality that is provided by
		the network device.

      </con-toe>
      <con-sec-prob>
		The threats and assumptions defined by this PP-Module (see sections 3.1 and 3.2) supplement those
		defined in the NDcPP as follows:
	  </con-sec-prob>
      <con-obj></con-obj>
      <con-op-en>The objectives for the TOE’s operational environment are consistent with the NDcPP based on the following rationale: </con-op-en>
      
      
		<con-mod ref="T.UNDETECTED_TRANSMISSION">
			The NDcPP defines threats for insecure communications and undetected
			activity. Unauthorized and undetected use of a communications channel is
			consistent with these threats.
		</con-mod>
		<con-mod ref="T.MEDIA_DISCLOSURE">
			The NDcPP defines a threat for untrusted communications channels. The
			threat of media disclosure through vocoder frames is a type of sidechannel attack that is unique to the functions of a VVoIP endpoint.
			However, it is consistent with the overall threat of unintended disclosure
			of sensitive data.
		</con-mod>
		<con-mod ref="A.UPDATE_SOURCE">
			The NDcPP does not have any assumptions for the source of TOE updates,
			only that the updates have adequate integrity protections. There is no
			conflict with this Module assuming that TOE updates will be retrieved
			from a particular location.
		</con-mod>
		  
		<con-mod ref="OE.UPDATE_SOURCE">
			The NDcPP requires the TOE to be able to apply software/firmware updates
			but does not define any specific way that these updates need to be made
			available. This PP-Module defines an objective that allows for an assumption
			that TOE updates will be made available in a specific location.
			A.UPDATE_SOURCE is consistent with the Base-PP objectives for the same
			reason.
		</con-mod>
    	
    	<con-mod ref="fau-gen-1-ips">The PP-Module iterates an SFR defined in the Base-PP to define additional
    		audit events specific to IPS functionality that the IPS part of the TOE must
    		generate.</con-mod>
    	<con-mod ref="fmt-smf-1-ips">The PP-Module iterates an SFR defined in the Base-PP to define additional
    		management functions specific to the IPS functionality that the IPS part of the TOE must generate. Authorizations to perform these functions are based
    		on FMT_SMR.2 defined by the Base-PP.</con-mod>
    	<con-mod ref="ips-abd-ext-1">This SFR applies to IPS functionality, which is beyond the original scope of
    		the Base-PP</con-mod>
    	<con-mod ref="ips-ipb-ext-1">This SFR applies to IPS functionality, which is beyond the original scope of
    		the Base-PP</con-mod>
    	<con-mod ref="ips-nta-ext-1">This SFR applies to IPS functionality, which is beyond the original scope of
    		the Base-PP</con-mod>
    	<con-mod ref="ips-sbd-ext-1">This SFR applies to IPS functionality, which is beyond the original scope of
    		the Base-PP</con-mod>
    	<con-mod ref="fau-stg-2-ips">The PP-Module iterates an SFR defined in the Base-PP to define an optional
    		capability for the protection of the IPS data generated by FAU_GEN.1/IPS.</con-mod>
    	<con-mod ref="fau-stg-5-ips">This SFR applies to IPS audit data, which is beyond the original scope of the
    		Base-PP.</con-mod>
    	<con-mod ref="fpt-fls-1-ips">This SFR applies to secure failure for inline interfaces, which is a type of
    		logical interface that was introduced in this PP-Module and therefore
    		doesn’t interfere with the Base-PP.</con-mod>
    	<con-mod ref="fru-rsa-1">This SFR applies to quota enforcement on network interfaces that perform
    		scanning of network traffic for enforcement of IPS requirements. This
    		functionality was introduced in this PP-Module and therefore doesn’t
    		interfere with the Base-PP.</con-mod>
    	<con-mod ref="ips-sbd-ext-2">This SFR applies to IPS functionality, which is beyond the original scope of
    		the Base-PP</con-mod>
    	<con-mod ref="fau-arp-1">This SFR applies to IPS functionality, which is beyond the original scope of
    		the Base-PP</con-mod>
    	<con-mod ref="fau-sar-1">This SFR applies to review of collected IPS data, which is beyond the scope of
    		the original Base-PP.</con-mod>
    	<con-mod ref="fau-sar-2">This SFR applies to review of collected IPS data, which is beyond the scope of
    		the original Base-PP.</con-mod>
    	<con-mod ref="fau-sar-3">This SFR applies to review of collected IPS data, which is beyond the scope of
    		the original Base-PP.</con-mod>
	  
    </base-pp>
	<base-pp id="APP" version="1.4" name="Application Software" product="Application Software" short="APP" plural="Application Software">
		<git>
			<url>https://github.com/commoncriteria/application</url>
			<branch>release-1.4</branch>
		</git>
		<url>https://www.niap-ccevs.org/protectionprofiles/462</url>
		
		<sec-func-req-dir>
			In a PP-Configuration that includes the App PP, the VVoIP client is expected to rely on some of the security
			functions implemented by the software application as a whole and evaluated against the App PP. In this
			case, the following sections describe any modifications that the ST author must make to the SFRs defined
			in the App PP in addition to what is mandated by section 5.3.
			<!-- QQQQ:TODO: Verify this session number is correct. -->
		</sec-func-req-dir>
		<modified-sfrs>
			<section title="Protection of the TSF (FPT)" id="app-mod-fpt">
				<base-sfr-spec cc-id="fpt_tud_ext.1" title="Trusted Update" id="app-mod-fpt-tud-ext-1">
					<consistency-rationale>This PP-Module does not modify this SFR; it only specifies that the source of
						TOE software/firmware updates must be a specific type of server.</consistency-rationale>
					<description>
						This PP-Module does not modify this SFR as it is defined in the App PP. However, note that this PP-Module
						expects that either the call control server or a separate file server managed by the organization to function
						as the source of TOE software/firmware updates. The evaluator shall ensure that the test environment is
						configured appropriately.
					</description>
					<no-change/>
				</base-sfr-spec>
			</section>
			<section title="Trusted Path/Channel (FTP)" id="app-mod-ftp">
				<base-sfr-spec cc-id="ftp_dit_ext.1" title="Protection of Data in Transit" id="app-mod-ftp-dit-ext-1">
					<consistency-rationale>
						This PP-Module modifies the App PP SFR by mandating the use of trusted
						communications to secure transmitted data, mandating support for TLS, and
						permitting support for SRTP. The first two modifications are derived from
						selections that are already present in the App PP version of the SFR. The
						addition of SRTP does not prevent any of the other protocols from being
						used if supported.
					</consistency-rationale>
					<description>
						<h:p>This SFR is modified from its definition in the Base-PP to mandate the inclusion of TLS as a method to protect data 
						and to add support for the use of SRTP to protect data in transit.</h:p>
						<h:p>The text of the requirement is replaced with:</h:p>
						<h:p><h:b>FTP_DIT_EXT.1.1: </h:b>
							The application shall [<h:b>selection: </h:b>
							<h:ul>
								<h:li><h:i>encrypt all transmitted [<h:b>selection: </h:b>
							sensitive data, data] with <h:b>TLS as defined in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/465">Functional Package for TLS, version 2.0</h:a></h:b> and 
							[<h:b>selection: </h:b>HTTPS as a client in accordance with FCS_HTTPS_EXT.1/Client, HTTPS as a server in accordance with FCS_HTTPS_EXT.1/Server, 
							HTTPS as a server using mutual authentication in accordance with FCS_HTTPS_EXT.2, 
							DTLS as defined in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/465">Functional Package for TLS, version 2.0</h:a>, 
							SSH as defined in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/515">Functional Package for SSH, version 2.0</h:a>, 
							IPsec as defined in the <h:a href="https://www.niap-ccevs.org/protectionprofiles/487">PP-Module for VPN Client, version 2.5</h:a>
							<h:b>Secure Real-Time Transport Protocol (SRTP), no other protocols</h:b>],</h:i></h:li>
							<h:li><h:i>invoke platform-provided functionality to encrypt all transmitted sensitive data with <h:b>TLS and </h:b>
							[<h:b>selection: </h:b>HTTPS, DTLS, SSH, <h:b>no other protocols</h:b>],</h:i></h:li>
							<h:li><h:i>invoke platform-provided functionality to encrypt all transmitted data with <h:b>TLS and </h:b>
							[<h:b>selection: </h:b>HTTPS, DTLS, SSH, <h:b>no other protocols</h:b>]</h:i></h:li>
							</h:ul>
							] between itself and another trusted IT product.
						</h:p>
						<h:p><h:b>Application Note: </h:b>
							The App PP provides the ability for the ST author to specify the protocols used to
							establish trusted communications and the behavior that trusted communications
							are used to protect. This PP-Module mandates the inclusion of TLS because it is
							the underlying protocol used to secure communications with a VVoIP call control
							server and other VVoIP endpoints. Additional protocols may be selected if they are
							used for securing other channels. For example, the TSF may communicate with an ESC using TLS for call control functions but some other protocol for remote
							transmission of audit data.
						</h:p><h:p>
							Since the App PP does not define separate SFRs for trusted channel (TOE to trusted
							third party) and trusted path (administrator to TOE), FTP_DIT_EXT.1 is expected
							to cover both use cases. The proper protocols should be selected accordingly.
						</h:p><h:p>
							Sensitive data includes at minimum call control/signal data, media data, and
							audit/management data.
						</h:p><h:p>
							If “SRTP” is selected in FTP_DIT_EXT.1.1, the selection-based SFRs
							FCS_COP.1/SRTP and FCS_SRTP_EXT.1 must be claimed.
						</h:p>
					</description>
					<replace>
						<xpath-specified xpath="*//cc:f-element[@id='fel-transmit']//cc:title">
							<title>The application shall 
								<selectables linebreak="yes">
									<selectable exclusive="yes">encrypt all transmitted 
										<selectables>
											<selectable exclusive="yes">sensitive data</selectable>
											<selectable exclusive="yes">data</selectable>
										</selectables> with <h:b>TLS as defined in the <xref to="pkgTLS"/> and</h:b>
										<selectables>
											<selectable id="sel_all_https_cl">HTTPS as a client in accordance with FCS_HTTPS_EXT.1/Client</selectable>
											<selectable id="sel_all_https_sv">HTTPS as a server in accordance with FCS_HTTPS_EXT.1/Server</selectable>
											<selectable id="sel_all_https_ma">HTTPS as a server using mutual authentication in accordance with FCS_HTTPS_EXT.2</selectable>
											<selectable id="sel_all_tls">TLS as defined in the <xref to="pkgTLS"/></selectable>
											<selectable id="sel_all_dtls">DTLS as defined in the <xref to="pkgTLS"/></selectable>
											<selectable id="sel_all_ssh">SSH as defined in the <xref to="pkgSSH"/></selectable>
											<selectable>IPsec as defined in the <xref to="pkgVPNC"/></selectable>
											<selectable><h:b>Secure Real-Time Transport Protocol (SRTP)</h:b></selectable>
											<selectable exclusive="yes"><h:b>no other protocols</h:b></selectable>
										</selectables>
									</selectable>
									<selectable exclusive="yes">invoke platform-provided functionality to encrypt all transmitted sensitive data with <h:b>TLS and</h:b>
										<selectables>
											<selectable>HTTPS</selectable>
											<selectable>DTLS</selectable>
											<selectable>SSH</selectable>
											<selectable exclusive="yes"><h:b>no other protocols</h:b></selectable>
										</selectables>
									</selectable>	    	      
									<selectable exclusive="yes">invoke platform-provided functionality to encrypt all transmitted data with <h:b>TLS and</h:b>
										<selectables>
											<selectable>HTTPS</selectable>
											<selectable>DTLS</selectable>
											<selectable>SSH</selectable>
											<selectable><h:b>no other protocols</h:b></selectable>
										</selectables>
									</selectable>	    	    
								</selectables> between itself and another trusted IT product.
							</title>
						</xpath-specified>
					</replace>
					<replace>
						<xpath-specified xpath="*//cc:f-element[@id='fel-transmit']//cc:note">
							<note role="application">
								The App PP provides the ability for the ST author to specify the protocols used to
								establish trusted communications and the behavior that trusted communications
								are used to protect. This PP-Module mandates the inclusion of TLS because it is
								the underlying protocol used to secure communications with a VVoIP call control
								server and other VVoIP endpoints. Additional protocols may be selected if they are
								used for securing other channels. For example, the TSF may communicate with an
								ESC using TLS for call control functions but some other protocol for remote transmission of audit data.
								<h:p/>
								Since the App PP does not define separate SFRs for trusted channel (TOE to trusted
								third party) and trusted path (administrator to TOE), FTP_DIT_EXT.1 is expected
								to cover both use cases. The proper protocols should be selected accordingly.
								<h:p/>
								Sensitive data includes at minimum call control/signal data, media data, and
								audit/management data.
								<h:p/>
								If “SRTP” is selected in FTP_DIT_EXT.1.1, the selection-based SFRs
								FCS_COP.1/SRTP and FCS_SRTP_EXT.1 must be claimed.
							</note>
						</xpath-specified>
					</replace>
				</base-sfr-spec>
			</section>
		</modified-sfrs>
		<additional-sfrs/>
		<con-toe>
			When this PP-Module is used to extend the App PP, the TOE type for the overall TOE is still a software
			application. The TOE boundary is simply extended to include the VVoIP endpoint functionality that is
			supported by the application.
		</con-toe>
		<con-sec-prob>
			The threats and assumptions defined by this PP-Module (see sections 3.1 and 3.2) supplement those
			defined in the App PP as follows:
		</con-sec-prob>
		<con-obj/>
		<con-op-en>The objectives for the TOE’s operational environment are consistent with the App-PP based on the following rationale:</con-op-en>
		<con-mod ref="T.UNDETECTED_TRANSMISSION">
			The App PP defines threats for network attack and network eavesdropping.
			Unauthorized and undetected use of a communications channel is
			consistent with these threats.
		</con-mod>
		<con-mod ref="T.MEDIA_DISCLOSURE">
			The App PP defines a threat for network eavesdropping. The threat of media
			disclosure through vocoder frames is a type of side-channel attack that is
			unique to the functions of a VVoIP endpoint. However, it is consistent with
			the overall threat of unintended disclosure of sensitive data.
		</con-mod>
		<con-mod ref="A.UPDATE_SOURCE">
			The App PP does not have any assumptions for the source of TOE updates,
			only that the updates have adequate integrity protections. There is no
			conflict with this Module assuming that TOE updates will be retrieved from a
			particular location.
		</con-mod>
		<con-mod ref="OE.UPDATE_SOURCE">
		<comment>This rationale could be interpreted as vague or conflicting with FPT_TUD_EXT.2, as applications 
		that are not packaged with the OS do have format requirements. There is no defined requirement for update location, since 
		there may be an alternate use case where "the place you get the app from" is different from "the mobile device vendor's app store" 
		because an MDM might have a separate mobile app server that devices enrolled in the MDM must use. Is this still an anticipated 
		use case? If so, the objective may need to be reworded in terms of a generic "trusted source" to make clear that 
		this module is not conflicting with FPT_TUD_EXT.2's requirements.</comment>
			The App PP requires the TOE to be able to apply software/firmware updates
			but does not define any specific way that these updates need to be made
			available. This PP-Module defines an objective that allows for an assumption
			that TOE updates will be made available in a specific location.
			A.UPDATE_SOURCE is consistent with the Base-PP objectives for the same
			reason.
		</con-mod>
	</base-pp>
	<man-sfrs>
    

		<!-- Audit table for Mandatory SFRs -->

		<!-- Section for SFR Class -->
		
		
			<!-- If this Class does not exist in the CC, then you need the following. -->
			<!-- Try not to create new classes. -->
<!--	        <class-description>A description of the new class.</class-description>        
			<ext-comp-class class="ClassName (ClassAbbr)">
				<description>Not sure what this is for.</description>
			</ext-comp-class>
-->
	
			<!-- For each family in the class that includes one or more  extended components  -->
			<!-- you need to povide an extended component definition like this. -->
<!--	        <ext-comp-def title="Cryptographic Key Management" fam-id="FCS_CKM_EXT">
			<fam-behavior>This family defines requirements for management of cryptographic keys.
				FCS_CKM_EXT.4 is necessary because FCS_CKM.4 does not include a requirement for the timing of 
				key destruction.
				FCS_CKM_EXT.5 is necessary to express requirements for key derivation, which are missing from Part 2. 
				</fam-behavior>
			</ext-comp-def>
-->			
			<!-- Next define all the components in the Class -->
			<!-- name: Name of the requirement as it should appear in the document -->
			<!-- id: Should look something like this, but it just needs to be unique in the document -->
			<!-- cc-id" This is a lower-case version of the SFR name as it would appear in a document -->
			<!-- iteration: This attribute is required only if the SFR is an iteration -->
		
		<section id="ss-audit-table" title="Auditable Events for Mandatory SFRs">
			<audit-table table="mandatory" id="at-mandatory">
	<!--			<h:br/><h:b><ctr ctr-type="Table" pre="Table " id="atref-mandatory">: Auditable Events for Mandatory SFRs</ctr></h:b> -->
			</audit-table>
		</section>
		
			<section title="Communications (FCO)" id="m-fco">
				<f-component name="Fixed-Rate Vocoder" cc-id="fco_voc_ext.1" id="fco-voc-ext-1">
					<f-element id="fco-voc-ext-1e1">
						<title>
							The TSF shall transmit voice media using a constant bit rate voice vocoder.
						</title>
						<note role="application">
							A constant bit rate vocoder provides a constant output length that does not have
							the vulnerabilities that a variable bit rate vocoder contains when encrypted.
						</note>
						<aactivity>
							<TSS>
								The evaluator shall verify that the TSS specifies each vocoder used. The evaluator shall then examine the
								specification for each vocoder in order to verify that no variable rate vocoders are claimed by the TSF.
							</TSS>
							<Guidance/>
							<Tests>The evaluator shall set up a test environment that contains the TOE, a call control server (which may be
								the TOE itself), a network switch, a packet capture tool, and a second VVoIP endpoint.
								The evaluator shall then perform the following test:
								<testlist>
									<test>
									<steplist>
										<step>The evaluator shall ensure the TOE and the second VVoIP endpoint are registered to a call
										control server or are using P2P.</step>	
										<step>.The evaluator shall use the TOE to dial the second VVoIP endpoint to establish a call and verify
										the call is established by holding a voice conversation.</step>
										<step>The evaluator shall review the captured traffic to verify that a fixed rate vocoder is used.</step>
									</steplist>
									If multiple vocoders are supported, the evaluator shall reconfigure the TOE to use each individual vocoder
									and repeat steps 1-3 for each vocoder.
									</test>
								</testlist>
							</Tests>
						</aactivity>
					</f-element>
					<audit-event/>
				</f-component>
			</section>
			
			<section title="User Data Protection (FDP)" id="m-fdp">
			<f-component name="Subset Information Flow Control" cc-id="fdp_ifc.1" id="fdp-ifc-1">
				<f-element id="fdp-ifc-1e1">
					<title>The TSF shall enforce the [<h:i>media transmission policy</h:i>] on [<h:i>voice/video media
					transmitted by the TOE</h:i>].
					</title>
					<note role="application">There are states when on-hook voice and video must not stream from the TOE.</note>
					<aactivity>
						<TSS>The evaluator shall verify that the TSS describes how streaming media is not transmitted when not in a streaming media state.</TSS>
						<Guidance/>
						<Tests>Testing of this component is performed through evaluation of FDP_IFF.1.</Tests>
					</aactivity>
				</f-element>
				<audit-event>
					<audit-event-descr>Call Detail Record (CDR) of VVoIP peer communications.</audit-event-descr>
					<audit-event-info>Calling party</audit-event-info>
					<audit-event-info>Called party</audit-event-info>
					<audit-event-info>Start time of call</audit-event-info>
					<audit-event-info>Call duration</audit-event-info>
				</audit-event>
			</f-component>
			
			<f-component name="Simple Security Attributes" cc-id="fdp_iff.1" id="fdp-iff-1">
				<f-element id="fdp-iff-1e1">
					<title>
						The TSF shall enforce the [<h:i>media transmission policy</h:i>] based on the following
						types of subject and information security attributes: [<h:i>TOE hook state, VVoIP call
						connection status, and VVoIP call control server status</h:i>].
					</title>
				</f-element>
				<f-element id="fdp-iff-1e2">
					<title>
						The TSF shall permit an information flow between a controlled subject and
						controlled information via a controlled operation if the following rules hold: [
						<h:i><h:ul>
							<h:li>The TOE is <selectables><selectable>registered with a VVoIP call control server</selectable>
								<selectable>acting as a VVoIP call control server when using P2P</selectable></selectables>,</h:li>
							<h:li>A call has been established with a telephony device (VVoIP endpoint),</h:li>
							<h:li>The TOE is in the off-hook state,</h:li>
							<h:li>The TOE is not in the mute state,</h:li>
							<h:li><selectables><selectable>The TOE is not in the hold state</selectable>
								<selectable exclusive="yes">no other rules</selectable></selectables></h:li>
						</h:ul></h:i>].
					</title>
				</f-element>
				<f-element id="fdp-iff-1e3">
					<title>The TSF shall enforce [<h:i>no additional information flow control policy rules</h:i>].</title>
				</f-element>
				<f-element id="fdp-iff-1e4">
					<title>The TSF shall explicitly authorize an information flow based on the following
						rules: [<h:i>no additional rules</h:i>].</title>
				</f-element>
				<f-element id="fdp-iff-1e5">
					<title>The TSF shall explicitly deny an information flow based on the following rules:
						[<h:i>all TCP and UDP ports used by the TOE are closed when not in active use</h:i>].</title>
					<aactivity>
						<TSS>The evaluator shall verify that the TSS describes the TOE’s enforcement of the media transmission policy
						and describes the conditions that are necessary for the TSF to transmit voice/video data to the operational
						environment.</TSS>
						<Guidance/>
						<Tests>The evaluator shall set up a test environment that contains the TOE, a call control server (which may be
						the TOE itself), a network switch, a traffic capture tool, and a second VVoIP endpoint.
						The evaluator shall then perform the following tests:
						<testlist>
							<test>(Conditional - physical TOE)
								<steplist>
									<step>The evaluator shall place the TOE into the on-hook state without registering it to the call control
									server or using P2P. The evaluator shall use the traffic capture tool to verify that the TOE does
									not transmit any streaming media traffic.</step>
									<step>The evaluator shall place the TOE into the off-hook state and use the traffic capture tool to
									verify that the TOE does not transmit any streaming media traffic.</step>
								</steplist>
							</test>
							<test>(Conditional - software application TOE)
								<steplist>
									<step>The evaluator shall execute the VVoIP application without registering it to the call control server
									or using P2P. The evaluator shall use the traffic capture tool to verify that the TOE does not
									transmit any streaming media traffic.</step>
									<step>The evaluator shall place the TOE into the off-hook state (e.g., by performing a call without
									specifying any destination data). The evaluator shall use the traffic capture tool to verify that the
									TOE does not transmit any streaming media traffic.</step>
								</steplist>
							</test>
							<test>
								<steplist>
									<step>The evaluator shall ensure the TOE is using P2P or register the TOE with the call control server
									and verify that the TOE is registered by checking the call control server screen with current TOE
									connections and by viewing the call control path traffic using the traffic capture tool.</step>
									<step>The evaluator shall place the TOE into the on-hook state and verify using the traffic capture tool
									that no streaming media traffic is transmitted by the TOE.</step>
									<step>The evaluator shall place the TOE into the off-hook state. The evaluator shall then verify that the
									TOE continues to not transmit streaming media traffic.</step>
								</steplist>
							</test>
							<test>
								<steplist>
									<step>The evaluator shall ensure the TOE is using P2P or shall register the TOE with the call control
									server and verify that it is registered by checking the call control server with current connections
									and using the traffic capture tool to verify the call control path traffic.</step>
									<step>The evaluator shall ensure the TOE is using P2P or shall register the second VVoIP endpoint with
									the call control server and verify that it has been registered by checking the call control server
									with current connections and using the traffic capture tool to verify the call control path traffic.</step>
									<step>The evaluator shall use the TOE to dial the second VVoIP endpoint and connect a call. The
									evaluator shall verify that the connection is made by having a voice/video conversation with the
									endpoint and using the traffic capture tool to verify that a steady stream of traffic is being
									transmitted between the two endpoints over the media channel.</step>
									<step>The evaluator shall use the TOE to put the call on mute and verify that no traffic is transmitted
									from the TOE over the media channel to the second VVoIP endpoint. If the TOE is registered to a
									call control server, the evaluator shall also verify that a mute control message is sent to the call
									control server and it responds.</step>
									<step>The evaluator shall use the TOE to take the call off mute and verify that the streaming media
									traffic between the TOE and the second VVoIP endpoint is resumed.</step>
								</steplist>
							</test>
							<test>
								<steplist>
									<step>The evaluator shall ensure the TOE is using P2P or register the TOE to the call control server and
									place it in the on-hook state.</step>
									<step>The evaluator shall use a fuzzing tool to attempt to connect to the TOE on the full range of TCP
									ports used by the TSF. All ports used by the TOE should be closed except for the port that is used
									to communicate with the ESC.</step>
								</steplist>
							</test>
							<test>
								<steplist>
									<step>The evaluator shall ensure the TOE and the second VVoIP endpoint are registered to a call
									control server or are using P2P.</step>
									<step>The evaluator shall place the TOE in the on-hook state.</step>
									<step>The evaluator shall use a fuzzing tool to attempt to connect to the TOE on the full range of UDP
									ports used by the TSF. All ports used by the TOE should be closed.</step>
									<step>The evaluator shall place a call to the second VVoIP endpoint and verify the call is established.
									The evaluator shall capture the traffic to determine the port used by the TOE to carry the media
									traffic.</step>
									<step>The evaluator shall hang up the call and verify that the TOE has returned to the on-hook state.</step>
									<step>The evaluator shall perform fuzzing activities to verify that the port used to carry media traffic in
									step 4 has been closed.</step>
								</steplist>
							</test>
							<test>(Conditional - "The TOE is not in the hold state" is selected in FDP_IFF.1.2)
								<steplist>
									<step>The evaluator shall use the TOE to put the call on hold and verify that no streaming media traffic
									is transmitted from the TOE over the media channel. If the TOE is registered to a call control
									server, the evaluator shall also verify that the VVoIP endpoint on-hold call control is sent to the
									call control server and it responds.</step>
									<step>The evaluator shall use the TOE to take the call off hold and verify that the streaming media
									traffic between the TOE and the second VVoIP endpoint is resumed.</step>
								</steplist>
							</test>
						</testlist>
						</Tests>
					</aactivity>
				</f-element>
				<audit-event/>
			</f-component>
			</section>
			
			<section title="Security Management (FMT)" id="m-fmt">
			<f-component name="Specification of Management Functions (VVoIP Communications)" cc-id="fmt_smf.1" iteration="VVoIP" id="fmt-smf-1-vvoip">
				<f-element id="fmt-smf-1e1-vvoip">
				<title>
				The TSF shall be capable of performing the following management functions: [
					<h:i><h:ul>
					<h:li>Ability to <selectables>
						<selectable>register the TOE to an ESC <selectables><selectable>manually</selectable><selectable>via DHCP server</selectable></selectables></selectable>
						<selectable>act as a VVoIP call control server when using P2P</selectable></selectables>;
					</h:li></h:ul>
					<selectables linebreak="yes">
						<selectable>Ability to configure audit behavior (e.g. changes to storage
						locations for audit; changes to behavior when local audit
						storage space is full);</selectable>
						<selectable>Ability to modify the behavior of the transmission of audit data
						to an external IT entity;</selectable>
						<selectable>Ability to configure the termination period for idle calls;</selectable>
						<selectable>Ability to specify the vocoder used;</selectable>
						<selectable>Ability to disable SRTP NULL algorithm;</selectable>
						<selectable>Ability to specify the ports to be used for SRTP communications;</selectable>
						<selectable exclusive="yes">no other capabilities</selectable>
					</selectables>
					</h:i>
					].
				</title>   
				<note role="application">
					This SFR defines additional management functions for the TOE beyond what is
					defined in each of the supported Base-PPs as FMT_SMF.1. The TOE may have all
					management functionality implemented in the same logical interface; it is not
					necessary for the Base-PP management functions and the PP-Module’s
					management functions to be implemented separately.
					<h:p/>
					The audit-related sections are duplicates of those in the NDcPP’s definition of
					FMT_SMF.1. If the VVoIP audit functionality is configurable separately from the
					auditing for the device as a whole, the relevant selections should be made or
					omitted in each iteration as needed.
					<h:p/>
					If the TOE claims conformance to the NDcPP and “register the TOE to an ESC…” is
					selected, the selection-based SFR FCS_NTP_EXT.1 must be claimed since
					connectivity to an ESC implies that the TSF will use it as an NTP server.
				</note>         
				<aactivity>      <!-- at minimum, only the last f-element in the f-component needs to have this -->
   					<TSS>
					The evaluator shall verify that the TSS provides a description of the TOE initial configuration and describes
					the ability of the TSF to manage the functions that are defined in the SFR, including how each function is
					managed (e.g. manually configured, applied via downloaded configuration file).</TSS>
					<Guidance>
					The evaluator shall verify that the operational guidance provides instructions on configuring any
					functionality specifically related to VVoIP.
					</Guidance>
					<Tests>
						The evaluator shall perform the following tests, depending on the selections made:
						<testlist>
						<test>(Conditional - "register the TOE to an ESC [manually]" is selected)
							<steplist>
								<step>On the TOE, input IP address, gateway address, and subnet mask.</step>
								<step>If the operational environment is deployed in a manner such that the configuration server and
								ESC are two distinct servers, input the addresses for each; otherwise, input the ESC address.</step>
								<step>Save the configuration.</step>
								<step>Verify the TOE registers to the ESC.</step>
							</steplist>
						</test>
						<test>(Conditional - "register the TOE to an ESC [via DHCP server]" is selected
							<steplist>
								<step>On the TOE, input the DHCP server address.</step>
								<step>Verify by traffic capture that the TOE receives all needed IP addresses.</step>
								<step>Verify by examining the IP address on the TOE.</step>
								<step>Verify the TOE registers to the ESC. </step>
							</steplist>
						Test EAs to verify that the TOE can act as a VVoIP call control server when using P2P (if it is selected) are
						performed as part of testing for FDP_IFF.1/CallControl.
						<h:p/>
						Test EAs to verify the configuration of audit behavior are performed as part of testing for FAU_STG_EXT.1.
						<h:p/>
						Test EAs to verify the modification of transmission of audit data to an external IT entity are performed as
						part of testing for FAU_STG_EXT.1.
						<h:p/>
						Test EAs to verify that the idle call termination period can be specified are performed as part of testing
						for FTA_SSL.3/Media, specifically Test 2 and Test 3.
						<h:p/>
						Test EAs to verify that the vocoder can be specified are performed as part of testing for FCO_VOC_EXT.1.
						</test>
						</testlist>
					</Tests>
            	</aactivity>
                </f-element>
				<audit-event type="optional">
					<audit-event-descr>Registration of TOE to ESC.</audit-event-descr>
					<audit-event-info type="optional">IP address or identifier for the ESC</audit-event-info>
				</audit-event>	
			</f-component>
			</section>

			<section title="TOE Access (FTA)" id="m-fta">			
			<f-component name="TSF-Initiated Termination (Media Channel)" cc-id="fta_ssl.3" iteration="MEDIA" id="fta-ssl-3-media">
				
				<f-element id="fta-ssl-3e1-media">
				<title>
				The TSF shall terminate voice/video transmission after [<h:i>inactivity longer than
					<selectables>
						<selectable><assignable>default number of seconds</assignable> seconds</selectable>
						<selectable>an administrator-configurable interval</selectable>
					</selectables></h:i>].
				</title>  
				<note role="application">
				This SFR is intended to mitigate the potential unauthorized disclosure of media
				data in the case where connectivity with the peer is lost. The ST author should
				choose one or both selections if applicable. Note that if “an administratorconfigurable interval” is selected, the ST author must select “configure the
				termination period for idle calls” in FMT_SMF.1.1/VVoIP. 
				</note>
	          
				<aactivity>
					<TSS>The evaluator shall verify that the TSS specifies whether idle calls are terminated by default after a certain
					amount of time or by an administrator-configurable interval.</TSS>
					<Guidance>If the idle call timeout period is administrator-configurable, the evaluator shall verify that the operational
					guidance includes instructions for how to configure this, as well as what the minimum and maximum
					allowed values are.</Guidance>
					<Tests>
					The evaluator shall set up a test environment that contains the TOE, a call control server (which may be
					the TOE itself), a configuration server (if used to communicate configuration changes to idle timeout
					period), a network switch, a traffic capture tool, and a second VVoIP endpoint.
					The evaluator shall then perform the following tests:
						<testlist>
							<test>
								<steplist>
									<step>Deploy the TOE in a default configuration (i.e. without any administrative override applied to
									the idle timeout value).</step>
									<step>Ensure the TOE is using P2P or register the TOE with the call control server and verify that it is
									registered by viewing its status on the ESC and capturing the call control path traffic.</step>
									<step>Ensure the second VVoIP endpoint is using P2P or register the second VVoIP endpoint with the
									call control server and verify that it is registered by viewing its status on the call control server
									and capturing the call control path traffic.</step>
									<step>Use the TOE to dial the second VVoIP endpoint and establish a call. Verify the call was
									established by holding a conversation between the two peers and capturing the streaming
									media traffic that is transmitted between them.</step>
									<step>Power down the second VVoIP endpoint while the call is active. Observe that the TOE stops
									transmitting media after the default period of time specified in the ST.</step>
								</steplist>
							</test>
							<test>(Conditional - "an administrator-configurable interval is selected in FTA_SSL.3.1/Media)
								<steplist>
									<step>Deploy the TOE in a default configuration (i.e. without any administrative override applied to
									the idle timeout value).</step>
									<step>Ensure the TOE is using P2P or register the TOE with the call control server and verify that it is
									registered by viewing its status on the call control server and capturing the call control path
									traffic.</step>
									<step>Configure the TOE’s idle timeout period for the shortest period of time that is supported.</step>
									<step>Ensure the second VVoIP endpoint is using P2P or register the second VVoIP endpoint with the
									call control server and verify that it is registered by viewing its status on the call control server
									and capturing the call control path traffic.</step>
									<step>Use the TOE to dial the second VVoIP endpoint and establish a call. Verify the call was
									established by holding a conversation between the two peers and capturing the streaming
									media traffic that is transmitted between them.</step>
									<step>Power down the second VVoIP endpoint while the call is active. Observe that the TOE stops
									transmitting media after the period of time configured in Step 3.</step>
								</steplist>
							</test>	
							<test>(Conditional - "an administrator-configurable interval" is selected in FTA_SSL.3.1/Media)<h:p/>
							Repeat Test 2 but in Step 3, configure the idle timeout value to be the longest period of time that is
							supported as opposed to the shortest.
							</test>
						</testlist>
					</Tests>
				</aactivity>
				</f-element>	
				<audit-event>
					<audit-event-descr>Termination of a call due to inactivity.</audit-event-descr>
					<audit-event-info>Call party dropped time</audit-event-info>
				</audit-event>		
				</f-component>
				</section>

				<section title="Trusted Path/Channels (FTP)">
							
				<f-component name="Inter-TSF Trusted Channel (Signaling Channel)" cc-id="ftp_itc.1" iteration="CONTROL" id="ftp-itc-1-control">
					
				<f-element id="ftp-itc-1e1-control">
					<title>
					The TSF shall <h:b>be capable of using <selectables><selectable>Session Initiation Protocol (SIP)</selectable><selectable>H.323</selectable></selectables> 
					to </h:b>provide a trusted communication channel between itself and <h:b>a VVoIP
					call control server</h:b> that is logically distinct from other communication channels
					and provides assured identification of its end points and protection of the channel
					data from modification or disclosure.


					</title>
					<note role="application">
						Both the SIP and H.323 protocols rely on TLS. This SFR defines the application layer
						protocol used to secure call control functions.
					</note>
				
				</f-element>
				<f-element id="ftp-itc-1e2-control">
					<title>
						The TSF shall permit [<h:i>the TSF, <h:b>the VVoIP call control server</h:b></h:i>] to initiate communication 
						via the trusted channel.
					</title>
				</f-element>
				<f-element id="ftp-itc-1e3-control">
					<title>The TSF shall initiate communication via the trusted channel for [<h:i>establishment of call control</h:i>].</title>
					
					<note role="application">The call control channel is secured with TLS as specified in FTP_DIT_EXT.1 from
					App PP or FTP_ITC.1 from NDcPP.</note>
					<aactivity>      <!-- at minimum, only the last f-element in the f-component needs to have this -->
						<TSS>
							The evaluator shall verify that the TSS describes the ability of the TOE to use SIP and/or H.323 with TLS.
						</TSS>
						<Guidance/>
						<Tests>
							The vendor shall provide to the evaluator application layer configuration settings for all secure
							communication mechanisms specified by the FTP_ITC.1/Control requirement. This information should be
							sufficiently detailed to allow the evaluator to determine the application layer timeout settings for each
							cryptographic protocol. There is no expectation that this information must be recorded in any public-facing document or report.
							<h:p/>
							The evaluator shall perform the following tests:
								<testlist>
									<test>The evaluators shall ensure that communications using each protocol with a call control server is
										tested during the course of the evaluation, setting up the connections as described in the guidance
										documentation and ensuring that communication is successful.</test>
									<test>For each protocol that the TOE can initiate as defined in the requirement, the evaluator shall follow
										the guidance documentation to ensure that in fact the communication channel can be initiated from the TOE.</test>
									<test>The evaluator shall ensure, for each communication channel with an authorized IT entity, the
										channel data is not sent in plaintext.</test>
									<test>
									<h:p>Objective: The objective of this test is to ensure that the TOE reacts appropriately to any
										connection outage or interruption of the route to the external IT entities. </h:p>
									<h:p>The evaluator shall, for a connection to a call control server using each claimed protocol, physically
										interrupt the connection to the call control server for the following durations: i) a duration that exceeds
										the TOE’s application layer timeout setting, ii) a duration shorter than the application layer timeout but
										of sufficient length to interrupt the MAC layer. </h:p>
									<h:p>The evaluator shall ensure that, when the physical connectivity is restored, communications are
										appropriately protected and no TSF data is sent in plaintext. </h:p>
									<h:p>In the case where the TOE is able to detect when the cable is removed from the device, another physical
										network device (e.g. a core switch) shall be used to interrupt the connection between the TOE and the
										call control server. The interruption shall not be performed at the virtual node (e.g. virtual switch) and
										must be physical in nature.</h:p>
									<h:p>Further EAs are associated with the specific protocols.</h:p>
									</test>
								</testlist>
						</Tests>
					</aactivity>
				</f-element>
				<audit-event>
					<audit-event-descr>Establishment of connection to VVoIP call control server</audit-event-descr>
					<audit-event-info>Called party</audit-event-info>
					<audit-event-info>Calling party</audit-event-info>
					<audit-event-info>Established connection time</audit-event-info>
					<audit-event-info>Terminated connection time</audit-event-info>
				</audit-event>
				<audit-event>
					<audit-event-descr>Termination of connection to VVoIP call control server</audit-event-descr>
					<audit-event-info>Called party</audit-event-info>
					<audit-event-info>Calling party</audit-event-info>
					<audit-event-info>Established connection time</audit-event-info>
					<audit-event-info>Terminated connection time</audit-event-info>
				</audit-event>
				</f-component>
							
				<f-component name="Inter-TSF Trusted Channel (Media Channel)" cc-id="ftp_itc.1" iteration="MEDIA" id="ftp-itc-1-media">
					
				<f-element id="ftp-itc-1e1-media">
					<title>
					The TSF shall <h:b>be capable of using <selectables><selectable>SRTP</selectable><selectable>H.235/H.323</selectable></selectables> 
					to </h:b>provide a trusted communication channel between itself and <h:b>another VVoIP
					endpoint or other telephony device</h:b> that is logically distinct from other communication channels
					and provides assured identification of its end points and protection of the channel
					data from modification or disclosure.


					</title>
					<note role="application">
						This SFR defines the application layer protocol used to secure voice/video
						transmissions once a call is established between another VVoIP endpoint or other
						telephony device such as a call conference device
					</note>
				
				</f-element>
				<f-element id="ftp-itc-1e2-media">
					<title>
						The TSF shall permit [<h:i>the TSF, <h:b>another VVoIP endpoint or other telephony device</h:b></h:i>] 
						to initiate communication via the trusted channel.
					</title>
				</f-element>
				<f-element id="ftp-itc-1e3-media">
					<title>The TSF shall initiate communication via the trusted channel for [<h:i>transmission of voice/video media</h:i>].</title>
					
					<note role="application">
					The corresponding trusted media channel must be chosen to match the trusted
					control channel: SIP – SRTP, H.323 – H.235/H.323. <h:p/>
					If “SRTP” is selected in FTP_ITC.1.1/Media, the selection-based SFRs
					FCS_COP.1/SRTP and FCS_SRTP_EXT.1 must be claimed.</note>
					<aactivity>      <!-- at minimum, only the last f-element in the f-component needs to have this -->
						<TSS>
							The evaluator shall verify that the trusted channel will use SRTP or H.323/H.235 in accordance with the selections made in the SFR.
						</TSS>
						<Guidance/>
						<Tests>
							The vendor shall provide to the evaluator application layer configuration settings for all secure
							communication mechanisms specified by the FTP_ITC.1/Media requirement. This information should be
							sufficiently detailed to allow the evaluator to determine the application layer timeout settings for each
							cryptographic protocol. There is no expectation that this information must be recorded in any public-facing document or report.
							<h:p/>
							The evaluator shall perform the following tests:
								<testlist>
									<test>The evaluators shall ensure that communications using each protocol with another VVoIP endpoint is
										tested during the course of the evaluation, setting up the connections as described in the guidance
										documentation and ensuring that communication is successful.</test>
									<test>For each protocol that the TOE can initiate as defined in the requirement, the evaluator shall follow
										the guidance documentation to ensure that in fact the communication channel can be initiated from the TOE.</test>
									<test>The evaluator shall ensure, for each communication channel with an authorized IT entity, the
										channel data is not sent in plaintext.</test>
									<test>
									<h:p>Objective: The objective of this test is to ensure that the TOE reacts appropriately to any
										connection outage or interruption of the route to the external IT entities. </h:p>
									<h:p>The evaluator shall, for a connection to another VVoIP endpoint device using each claimed protocol, physically
										interrupt the connection to that remote endpoint for the following durations: i) a duration that exceeds
										the TOE’s application layer timeout setting, ii) a duration shorter than the application layer timeout but
										of sufficient length to interrupt the MAC layer. </h:p>
									<h:p>The evaluator shall ensure that, when the physical connectivity is restored, communications are
										appropriately protected and no TSF data is sent in plaintext. </h:p>
									<h:p>In the case where the TOE is able to detect when the cable is removed from the device, another physical
										network device (e.g. a core switch) shall be used to interrupt the connection between the TOE and the
										call control server. The interruption shall not be performed at the virtual node (e.g. virtual switch) and
										must be physical in nature.</h:p>
									<h:p>Further EAs are associated with the specific protocols.</h:p>
									</test>
								</testlist>
						</Tests>
					</aactivity>
				</f-element>
				<audit-event>
					<audit-event-descr>Establishment of connection to VVoIP peer</audit-event-descr>
					<audit-event-info>Called party</audit-event-info>
					<audit-event-info>Calling party</audit-event-info>
					<audit-event-info>Established connection time</audit-event-info>
					<audit-event-info>Terminated connection time</audit-event-info>
				</audit-event>
				<audit-event>
					<audit-event-descr>Termination of connection to VVoIP peer</audit-event-descr>
					<audit-event-info>Called party</audit-event-info>
					<audit-event-info>Calling party</audit-event-info>
					<audit-event-info>Established connection time</audit-event-info>
					<audit-event-info>Terminated connection time</audit-event-info>
				</audit-event>
				</f-component>
			</section>


	
	</man-sfrs>  <!-- SFRs -->
    
    <opt-sfrs>
		<section id="sec-opt-audit-table" title="Auditable Events for Optional SFRs">
        <audit-table id="at-optional" table="optional"/>
      </section>
	<section title="Security Audit(FAU)" id="fau-ops">
			<f-component name="Audit Data Generation (Client-Server Admin Events)" cc-id="fau_gen.1" iteration="CSADMIN" id="fau-gen-1-csadmin">
			<f-element id='fau-gen-1e1-csadmin'>
				<title>The <h:b><selectables>
				<selectable>TSF</selectable>
				<selectable>TOE platform</selectable></selectables></h:b>
				 shall be able to generate audit data of the following auditable events:
				 <h:ol type="a">
				 	<h:li><h:s>Start-up and shutdown of the audit functions;</h:s></h:li>
					<h:li><h:s>All auditable events for the <selectables choose-one-of="yes">
						<selectable>minimum</selectable>
						<selectable>basic</selectable>
						<selectable>detailed</selectable>
						<selectable>not specified</selectable></selectables> level of audit;</h:s></h:li>
					<h:li>[<h:i>All administrative actions comprising:
						<h:ol type="i">
							<h:li>Administrative login and logout (name of user account shall be
								logged if individual user accounts are required for
								Administrators).</h:li>
							<h:li>Changes to TSF data related to configuration changes (in
								addition to the information that a change occurred it shall be
								logged what has been changed).</h:li>
							<h:li>Generating/import of, changing, or deleting of cryptographic
								keys (in addition to the action itself a unique key name or key
								reference shall be logged).</h:li>
							<h:li>Resetting passwords (name of related user account shall be logged).</h:li>
							<h:li><selectables>
									<selectable><assignable>list of other uses of privileges</assignable></selectable>
									<selectable>no other actions</selectable></selectables></h:li>
						</h:ol></h:i></h:li>].
				 </h:ol>
				
				</title>
				<note role="application">
				<h:p>This SFR defines the same auditable events as FAU_GEN.1/P2P-Admin in
					Appendix B below. It is defined as a separate iteration because when the TOE
					is deployed in a client-server architecture, the Enterprise Session Controller is
					expected to be responsible for the relevant auditing, so this capability is
					optional when the TOE is not peer-to-peer. </h:p>
				<h:p>If the TOE claims this SFR and conforms to the App PP, the implementationdependent SFR FAU_STG_EXT.1 must also be claimed. This does not need to
					be claimed when the TOE conforms to the NDcPP because that PP already
					defines FAU_STG_EXT.1 as a mandatory requirement.</h:p></note>
			</f-element>
			<f-element id='fau-gen-1e2-csadmin'>
				<title>
					The TSF shall record within the audit data at least the following information:
						<h:ol type="a">
							<h:li>Date and time of the auditable event, type of event, subject identity (if applicable), and the outcome (success or failure) of the event;</h:li>
							<h:li>For each auditable event type, based on the auditable event definitions of the functional components included 
								in the PP, PP-Module, functional package or ST, [<h:i>no additional information</h:i>].</h:li>
						</h:ol>
				</title>
				<aactivity>
				<TSS/>
				<Guidance>The evaluator shall make a determination of the administrative actions related to TSF data related to
					configuration changes. The evaluator shall examine the guidance documentation and make a
					determination of which administrative commands, including subcommands, scripts, and configuration
					files, are related to the configuration (including enabling or disabling) of the mechanisms implemented in
					the TOE that are necessary to enforce the requirements specified in MOD_VVOIP_V1.0. The evaluator
					shall document the methodology or approach taken to TSF data related to configuration changes. The
					evaluator may perform this activity as part of the activities associated with ensuring that the
					corresponding guidance documentation satisfies the requirements related to it.
				</Guidance>
				<Tests>For each administrative action identified in FAU_GEN.1.1/CSADMIN, the evaluator shall perform an action
					either on the TOE or on the operational environment that causes the event to occur. The evaluator shall
					verify in each case that an auditable event was generated in a format consistent with the guidance
					documentation and that all audit record details specified in the SFR are present.
					<h:p/>
					Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly.
				</Tests>
			</aactivity>
				
			</f-element>
				<audit-event table="optional"/>
			</f-component>
		
			<f-component name="Audit Data Generation (Client-Server VVoIP Events)" cc-id="fau_gen.1" iteration="CSVVOIP" id="fau-gen-1-csvvoip">
			<f-element id='fau-gen-1e1-csvvoip'>
			<title>The TSF shall be able to generate audit data of the following auditable events:
				 <h:ol type="a">
				 	<h:li><h:s>Start-up and shutdown of the audit functions;</h:s></h:li>
					<h:li><h:s>All auditable events for the <selectables choose-one-of="yes">
						<selectable>minimum</selectable>
						<selectable>basic</selectable>
						<selectable>detailed</selectable>
						<selectable>not specified</selectable></selectables> level of audit;</h:s></h:li>
					<h:li>[<h:i>auditable events defined in the Auditable Events for Mandatory SFRs table (<xref to="at-mandatory"/>)</h:i>].</h:li>
				 </h:ol>
				</title>
			</f-element>
			<f-element id='fau-gen-1e2-csvvoip'>
				<title>
					The TSF shall record within the audit data at least the following information:
						<h:ol type="a">
							<h:li>Date and time of the auditable event, type of event, subject identity (if applicable), and the outcome (success or failure) of the event;</h:li>
							<h:li>For each auditable event type, based on the auditable event definitions of the functional components included 
								in the PP, PP-Module, functional package or ST, [<h:i>information specified in column three of the Auditable Events table 
								in which the event was defined</h:i>].</h:li>
						</h:ol>
				</title>
				<note role="application">
					<h:p>This SFR defines the same auditable events as FAU_GEN.1/P2P-VVoIP in
					Appendix B below. It is defined as a separate iteration because when the
					TOE is deployed in a client-server architecture, the Enterprise Session
					Controller is expected to be responsible for the relevant auditing, so this
					capability is optional when the TOE is not peer-to-peer.</h:p>
					
					<h:p>If the TOE claims this SFR and conforms to the App PP, the
					implementation-dependent SFR FAU_STG_EXT.1 must also be claimed.
					This does not need to be claimed when the TOE conforms to the NDcPP
					because that PP already defines FAU_STG_EXT.1 as a mandatory
					requirement.</h:p> 
				</note>
				<aactivity>
					<TSS/>
					<Guidance>The evaluator shall check the guidance documentation and ensure that it provides an example of each
						auditable event required by the PP-Module (i.e. at least one instance of each auditable event – comprising
						the mandatory, optional and selection-based SFR sections as applicable – shall be provided from the actual
						audit record).</Guidance>
					<Tests>
						<h:p>For each administrative action identified in the Auditable Events table in the PP-Module, the evaluator
							shall perform an action on the TOE that causes the event to occur. The evaluator shall verify in each case
							that an auditable event was generated in a format consistent with the guidance documentation and that
							all audit record details specified in the SFR are present.</h:p>
						<h:p>Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly.</h:p>
					</Tests>
				</aactivity>
			</f-element>
			<audit-event table="optional"/>
			</f-component>
	</section>
	</opt-sfrs>		
  	<sel-sfrs/>
	<obj-sfrs/>
    <impl-dep-sfrs>
    	<section title="Auditable Events for Implementation-Dependent SFRs">
    		<audit-table id="at-impl-dep" table="impl-dep"/>
    	</section>
	

	<section title="Security Audit (FAU)" id="fau-imp_dep">
		<f-component name="Protected Audit Event Storage" cc-id="fau_stg_ext.1" id="fau-stg-ext-1">
			<depends on="feat-swapp"/>
		<f-element>
		<title>The TSF shall be able to transmit the generated audit data to <h:b><selectables>
			<selectable>an Enterprise Session Controller that the TOE is registred to</selectable>
			<selectable>an external trusted IT entity</selectable>
		</selectables></h:b> using a trusted channel <h:b>according to FTP_DIT_EXT.1</h:b>.
		</title>
		</f-element>
		<f-element id="fau-stg-ext-1e2">
		<title>The TSF shall be able to store generated audit data on the <selectables>
			<selectable>TOE</selectable>
			<selectable>TOE platform</selectable></selectables>.</title>
		</f-element>
		<f-element>
		<title>The TSF shall <selectables>
			<selectable>drop new audit data</selectable>
			<selectable>overwrite previous audit records according to the following rule: <assignable>rule for overwriting previous audit records</assignable></selectable>
			<selectable><assignable>other action</assignable></selectable>
		</selectables>when the local storage space for audit data is full.</title>
		<aactivity>
			<TSS>The evaluator shall examine the TSS to ensure that it identifies all resources controlled through the quota
			mechanism, and that this list contains those resources used to support traffic inspection. The evaluator
			shall ensure that the TSS describes how each resource is counted as “used” and how a maximum quota
			or use is determined, as well as the action taken when the quota is reached.</TSS>
			<Guidance>The evaluator shall examine the operational guidance to determine that it contains instructions for
			establishing quotas (if they are configurable) and that it describes any actions administrators can or should
			take in response to a quota being reached.
			</Guidance>
			<Tests>The evaluator shall follow the operational guidance to configure quotas for the resource (if such a
			capability is provided). The evaluator then causes the resource quota to be reached, and observes that
			the action specified in the TSS occurs.</Tests></aactivity>
			
			</f-element>
			<audit-event table="impl-dep">
				<audit-event-descr>Traffic flow volume exceeds the maximum quota.</audit-event-descr>
				<audit-event-info>Identification of the TOE interface at which the quota was exceeded.</audit-event-info>
			</audit-event>
		</f-component>
		</section>
	</impl-dep-sfrs>
	


    </sec:Security_Requirements> <!-- Security Requirements  -->





  <!-- 
		The following sections are auto generated from the SFRs in the SFR section.
		Appendix A: Optional Requirements 
			A.1: Strictly Optional Requirements
			A.2: Objective requirements
			A.3: Implementation-dependent SFRs
		Appendix B: Selection-based requirements
		Appendix C: Extended Component Definitions (if any)
  -->


	<!-- This should be included if there are SFRs that are dependencies for included SFRs, 
	     but the dependencies are not incluuded in the PP. -->
	<appendix title="Inherently Satisfied Requirements" id="satisfiedreqs"> 
		This appendix lists requirements that should be considered satisfied by products
		successfully evaluated against this Protection Profile.  
		However, these requirements are not featured explicitly as SFRs and should not be
		included in the ST.  
		They are not included as standalone SFRs because it would
		increase the time, cost, and complexity of evaluation.  This approach is permitted
		by <xref g="CC"/> Part 1, <h:b>8.3 Dependencies between components</h:b>.
		<h:br/>
		This information benefits systems engineering activities which call for inclusion of 
		particular security controls.  Evaluation against the Protection Profile
		provides evidence that these controls are present and have been evaluated.
		<table xmlns="http://www.w3.org/1999/xhtml">
			<tr class="header">
				<td>Requirement</td>
				<td>Rationale for Satisfaction</td>
			</tr>
			<tr>
				<td><b>FAU_ARP.1 - Security Alarms</b></td>
				<td>FAU_ARP.1 has a dependency on FAU_SAA.1. This is
					because FAU_SAA.1 defines the behavior that the TSF may
					consider to be a potential security violation while
					FAU_ARP.1 defines what actions the TSF takes when such
					behavior is detected. This dependency is implicitly
					satisfied in this PP-Module because the behavior defined
					in FRU_RSA.1 and the various IPS class requirements
					collectively define potential security violation behavior so
					a separate SFR to enumerate this is redundant.
				</td>
			</tr>
			<tr>
				<td><b>FAU_GEN.1/IPS - Audit Data Generation (IPS)</b></td>
				<td>FAU_GEN.1 has a dependency on FPT_STM.1 The
					extended SFR FPT_STM_EXT.1 that is defined in the Base-PP provides equivalent functionality to FPT_STM.1 and
					therefore satisfies this dependency.</td>
			</tr>
		</table>
	</appendix>

	<!-- Entropy documentation -->
	<appendix title="Entropy Documentation and Assessment" id="entropyappendix"> 
		<h:p>
			The TOE does not require any additional supplementary information to describe its entropy sources
			beyond the requirements outlined in the Base-PP.
			</h:p>
	</appendix>
  


	<!-- Abbreviations appendix is auto generated here -->
	
	<!-- Bibliography is auto generated here with CC and CEM docs. If you want other docs -->
	<!-- included, add them here. -->
	<bibliography>
		<cc-entry/>
		<entry id="bibndcpp3">
			<tag>NDcPP</tag>
			<description>NDcPP  - <h:a
				href="https://www.niap-ccevs.org/protectionprofiles/482">Collaborative Protection Profile for Network Devices, Version 3.0e, December 06, 2023</h:a></description>
			
		</entry>
		
	</bibliography>

</Module>
<!-- </Package>  -->
